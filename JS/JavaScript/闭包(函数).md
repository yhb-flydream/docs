# 闭包(函数)

[TOC]

## 广义闭包

- 可以访问 **非自身的变量** 的 **函数**
- 从一种角度说所有函数都是闭包
- 另一种角度说只有使用了非自身变量的函数，才是闭包

## 狭义闭包

- `可以访问**非自身**的**局部变量**的**函数**(*面试说*)`
- 一种说法，**函数内的函数**才是闭包
- 另一种说法，使用了非自身**局部变量**的函数才是闭包
- **特点：**
- 可以通过闭包**在任何地方**操作**局部变量**

## 生命周期

- 一个生物，生命从开始到结束，中间存活的过程叫生命周期

- **变量的生命周期：**
- 一个变量，从**定义**开始，到**释放**结束，**中间存活的过程**叫变量的生命周期

- **全局变量的生命周期：**
  - 从**定义**开始，到**页面被卸载结束**，就是全局变量的生命周期

- **局部变量的生命周期：**
  - 从**定义**开始，到**函数执行完毕结束**，就是局部变量的生命周期
  - **但是，**可以通过闭包实现影响局部变量的生命周期，使生命周期和闭包一样长

- **问题：**
  - 如果一个变量一直存储着一个闭包函数，那么js引擎无法得知将来是否还会调用这个函数，所以就会造成这个函数不会被释放，相应的这个函数占用的局部变量也不会被释放，这就造成了内存浪费
  - 如果确定以后不会再使用这个函数了，最好手动将存储这个函数的变量赋值为 `null`

## 环境

- 一个东西所依赖东西，就可以认为是它的环境

- **执行环境：**
  - 代码执行时所依赖的环境
  - **函数被调用一次，就会产生一个执行环境**

## 闭包应用场景

- 操作私有属性(局部变量)
  - 为了防止其他地方对该属性随意修改的隐患
- 变量的状态：
  - 指变量不同时期所存储的值